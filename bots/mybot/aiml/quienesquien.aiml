<?xml version="1.0" encoding="UTF-8"?>
<aiml version="2.0">


<category>
	<pattern>^ jugar ^</pattern>
	<template>
		Quieres jugar al quien es quien
	</template>
</category>


<category>
	<pattern>Si</pattern>
	<that>QUIERES JUGAR AL QUIEN ES QUIEN</that>
	<template>
		Piensas un personaje o lo pienso yo
	</template>
</category>

<category>
	<pattern>^ yo ^</pattern>
	<that>PIENSAS UN PERSONAJE O LO PIENSO YO</that>
	<template>
		<think>
			<set name="sino">YES</set>
			<set name="trampa">end</set>
			<set name="personajes">Alejandro Alfonso Antonio Cristina Gabriela Ivan Javier Juan Laura Luis Marco Maria Paco Pepe Sofia Sonia</set>

			

			<set name="Pelo">rubio moreno marron calvo pelirrojo blanco negro</set>
			<set name="Ojos">claros oscuros</set>
			<set name="Gafas">si no</set>
			<set name="Bigote">si no</set>
			<set name="Barba">si no</set>
			<set name="Genero">hombre mujer</set>
			<set name="Piel">clara oscura</set>

			<set name="ask">Pelo Ojos Gafas Bigote Barba Genero Piel</set>
		</think>
		<srai>HACER PREGUNTA</srai>
	</template>
</category>



<category>
	<pattern>^ tu ^</pattern>
	<that>PIENSAS UN PERSONAJE O LO PIENSO YO</that>
	<template>
		









<category>
<pattern>HACER PREGUNTA</pattern>
<template>
	<think>

		<!-- EXTRAEMOS EL RASGO -->
	<set name="rasgo"><srai>TOP <get name="ask"/></srai></set>
	<!-- EXTRAEMOS EL VALOR -->
	<set name="valorrasgo"><srai>TOP <get> <name><get name="rasgo"/></name></get></srai></set>
	</think>
	<!-- BUSCAMOS Y HACEMOS LA PREGUNTA -->
	<set var="pregunta"><map><name><get name="rasgo"/></name><get name="valorrasgo"/></map></set>

	<think>
	<set name="topic">siono</set>
	</think>
</template>
</category>


<topic name="siono">
<category>
	<pattern>Si</pattern>
	<template>
		<!-- <get name="personajes"/> -->
		<think>
			<!-- BORRAMOS LA PREGUNTA -->
			<set name="ask"><srai>REMAIN <get name="ask"/></srai></set>
			<set name="sino">YES</set>
			<set name="trampa">
				<srai>ADDITEM <get name="rasgo"/> IN <get name="trampa"/></srai>
			</set>
		</think>
		<srai>BORRAR PERSONAJE</srai>
		
	</template>
</category>


<category>
	<pattern>No</pattern>
	<template>

		
		<think>
			<set> <name><get name="rasgo"/></name><srai>removeitem 1 IN <get> <name><get name="rasgo"/></name></get></srai></set>
		</think>
		<think>

			<set var="cnt">
				<srai>COUNT <get> <name><get name="rasgo"/></name></get></srai>
			</set>

			<condition var="cnt">
				<li value="1">
					<set name="valorrasgo">
						<srai>TOP <get> <name><get name="rasgo"/></name></get></srai>
					</set>
					<set name="trampa">
						<srai>ADDITEM <get name="rasgo"/> IN <get name="trampa"/></srai>
					</set>
					
					<set name="ask">
						<srai>REMAIN <get name="ask"/></srai>
					</set>
					<set name="sino">YES</set>
				</li>

				<li><set name="sino">NO</set></li>
			</condition>
		</think>
		<srai>BORRAR PERSONAJE</srai>
		
	</template>
</category>

</topic>



<category>
	<pattern>BORRAR PERSONAJE</pattern>
	<template>
			<think>
			<set var="item">
				<srai> ITERATE <get name="personajes"/> </srai>
			</set>
			</think>

			<!-- BUCLE QUE RECORRE EL SET -->
		
			<think>
			<condition var="item">
				<!-- MIENTRAS NO SEA EL TERMINADOR -->
				<li value="end"></li>
				<li> <get var="item"/>
					<!-- SACAMOS DEL MAP ASOCIADO AL PERSONAJE SU RESPUESTA A LA PREGUNTA -->
					<set var="busqueda"><map><name><get var="item"/></name><get name="rasgo"/></map></set>
					<!-- COMPARAMOS LA RESPUESTA -->
					<set var="iguales">
					<srai>
						COMPARE <get name="valorrasgo"/> WITH <get var="busqueda"/>
					</srai>
					</set>
					<!-- SI SON IGUALES NO HACEMOS NADA, SI SON DISTINTAS BORRAMOS -->
					<condition var="iguales">
						<li> <value><get name="sino"/></value></li>
						<li>

							<!-- BUSCAMOS LA POSICION -->
							<set var="pos">
								<srai>FINDITEM <get var="item"/> IN <get name="personajes"/></srai>
							</set>
							<!-- SI ES IGUAL LA BORRAMO -->
							<set name="personajes">
								<srai>
									REMOVEITEM <get var="pos"/> IN <get name="personajes"/>
								</srai>
							</set>
						</li>
					</condition>

					<!-- AVANZAMOS ITERACCIONES -->
					<think>
					<set var="item">
					<srai>NEXT</srai>
					</set>
					</think>
					<loop/>
				</li>
			</condition>


		</think>
		<!-- CONTAMOS NUMERO DE PERSONAJES -->
		<think>
			<set var="cantidad">
				<srai>COUNT <get name="personajes"/></srai>
			</set>
		</think>

		<!-- <get name="personajes"/> -->

		<!-- SI SOLO QUEDA UNO TERMINAMOS SI NO VOLVEMOS A PREGUNTAR -->

		<condition var="cantidad">
			<li value="1">
				<srai>ADIVINAR PERSONAJE</srai>
			</li>

			<li value="0">
				La respuestas no corresponden a ningun personaje. la proxima vez intenta jugar bien.
			</li>

			<li>
				<think>
				<set name="topic">unknown</set>
				</think>
				<srai>HACER PREGUNTA</srai>
			</li>
		</condition>
	</template>
</category>


<category>
	<pattern>ADIVINAR PERSONAJE</pattern>
	<template>
		<think>
		<set name="trampavalorrasgo">
			<srai>ADDITEM <get name="valorrasgo"/> IN <get name="trampavalorrasgo"/></srai>
		</set>
		</think>
		¿Es <set name="encontrado"><srai>TOP <get name="personajes"/></srai></set>?



		<think>
		<set name="topic">adivina</set>
		</think>
	</template>
</category>

<topic name="adivina">
<category>
	<pattern>Si</pattern>
	<template>
		¡¡¡¡Si esque soy el puto amo!!!!
		<think>
			<set name="topic">unknown</set>
		</think>
	</template>
</category>

<category>
	<pattern>No</pattern>
	<template>
		Quien es
	</template>
</category>

<category>
	<pattern><set>personajesenteros</set></pattern>
	<that>QUIEN ES</that>
	<template>

		<think>
			<set var="pers"><star/></set>
			<set var="err">,</set>
			<set var="tiene">,</set>
			<set var="notiene">,</set>
			<set var="erres">unknown</set>
			<set var="errmes">unknown</set>
			<set var="ras">
				<srai> ITERATE <get name="trampa"/> </srai>
			</set>
		</think>

		<think>
			<condition var="ras">
				<!-- MIENTRAS NO SEA EL TERMINADOR -->

				

				<li value="end"></li>
				<li>
					<set var="busqueda"><map><name><get var="pers"/></name><get var="ras"/></map></set>
					Busqueda vale: <get var="busqueda"/>

					<set var="busquedaenc"><map><name><get name="encontrado"/></name><get var="ras"/></map></set>

					<set var="iguales">
						<srai>
							COMPARE <get var="busquedaenc"/> WITH <get var="busqueda"/>
						</srai>
					</set>

					<condition var="iguales">
						<li value="YES"></li>
						<li>
							<condition var="ras">
								<li value="Barba">
									<condition var="busqueda">
										<li value="si">
											<set var="tiene">
												<srai>ADDITEM <get var="ras"/> IN <get var="tiene"/></srai>
											</set>
										</li>
										<li>
											<set var="notiene">
												<srai>ADDITEM <get var="ras"/> IN <get var="notiene"/></srai>
											</set>
										</li>
									</condition>
								</li>

								<li value="Gafas">
									<condition var="busqueda">
										<li value="si">
											<set var="tiene">
												<srai>ADDITEM <get var="ras"/> IN <get var="tiene"/></srai>
											</set>
										</li>
										<li>
											<set var="notiene">
												<srai>ADDITEM <get var="ras"/> IN <get var="notiene"/></srai>
											</set>
										</li>
									</condition>
								</li>

								<li value="Bigote">
									<condition var="busqueda">
										<li value="si">
											<set var="tiene">
												<srai>ADDITEM <get var="ras"/> IN <get var="tiene"/></srai>
											</set>
										</li>
										<li>
											<set var="notiene">
												<srai>ADDITEM <get var="ras"/> IN <get var="notiene"/></srai>
											</set>
										</li>
									</condition>
								</li>

								<li value="Genero">
									<set var="erres"><get var="busqueda"/></set>
									<set var="errmes"><get var="busquedaenc"/></set>

								</li>
								<li>
									<set var="tiene">
										<srai>ADDITEM <get var="busqueda"/> IN <get var="tiene"/></srai>
									</set>
									<set var="tiene">
										<srai>ADDITEM <get var="ras"/> IN <get var="tiene"/></srai>
									</set>
								</li>
							</condition>

							<!-- <set var="err">
								<srai>ADDITEM <get var="ras"/> IN <get var="err"/></srai>
							</set> -->
						</li>
					</condition>
					<think>
					<set var="ras">
						<srai>NEXT</srai>
					</set>
					</think>
					<loop/>
				</li>
			</condition>
		</think>
<!-- 
		el valor de erres es <get var="erres"/>
		el valor del otro es <get var="errmes"/> -->

		<condition var="erres">
			<li value="unknown">
				<condition var="tiene">
					<li value=",">
						<condition var="notiene">
							<li value=","></li>
							<li>Eso es mentira <star/> no tiene <get var="notiene"/> y tu me has dicho que si.</li>
						</condition>
					</li>
					<li>Eso es mentira <star/> tiene <get var="tiene"/> y tu me has dicho que no.</li>
				</condition>
			</li>

			<li>
				Mentira <star/> es <get var="erres"/> y <get var="pers"/> es <get var="errmes"/>.
			</li>
		</condition>

	</template>
</category>

</topic>



</aiml>